{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"The Trading Infrastructure Toolkit for Python  <p>   Research, simulate, and deploy algorithmic strategies \u2014 all in one place. </p> <p>Under Construction</p> <p>This package is under construction! OneSecondTrader is still a work in progress, but don\u2019t worry \u2013 a pre-release version is just around the corner. Grab a coffee and hang tight!</p>"},{"location":"#quickstart","title":"Quickstart","text":"<p>Step 1: Install package</p> pippoetry <pre><code>pip install onesecondtrader \n</code></pre> <pre><code>poetry add onesecondtrader\n</code></pre> <p>Step 2: Define strategy</p> <pre><code>from onesecondtrader.strategies import StrategyBase\nfrom onesecondtrader.indicators import SimpleMovingAverage\nfrom onesecondtrader.models import OrderType, OrderSide\nfrom onesecondtrader.events import BarReceived\n\n\nclass MySMACrossover(StrategyBase):\n    def setup(self) -&gt; None:\n        self.fast_sma = self.add_indicator(SimpleMovingAverage(period=20))\n        self.slow_sma = self.add_indicator(SimpleMovingAverage(period=100))\n\n    def on_bar(self, event: BarReceived) -&gt; None:\n        if (\n            self.fast_sma[-2] &lt;= self.slow_sma[-2]\n            and self.fast_sma.latest &gt; self.slow_sma.latest\n            and self.position &lt;= 0\n        ):\n            self.submit_order(OrderType.MARKET, OrderSide.BUY, 1.0)\n\n        if (\n            self.fast_sma[-2] &gt;= self.slow_sma[-2]\n            and self.fast_sma.latest &lt; self.slow_sma.latest\n            and self.position &gt;= 0\n        ):\n            self.submit_order(OrderType.MARKET, OrderSide.SELL, 1.0)\n</code></pre>"},{"location":"quickstart/","title":"\u2192 Quickstart","text":""},{"location":"quickstart/#redirecting","title":"Redirecting...","text":"<p>If you are not redirected automatically, click here.</p>"},{"location":"sql_primer/","title":"SQL Primer","text":"<p>SQL (Structured Query Language) is the language used to interact with databases. This page covers the SQL concepts needed to understand the schema of the securities master database.</p>"},{"location":"sql_primer/#tables","title":"Tables","text":"<p>A table is a collection of related data organized into rows and columns. A table is created by using the <code>CREATE TABLE</code> statement:</p> <pre><code>CREATE TABLE publishers (\n    publisher_id INTEGER PRIMARY KEY,\n    name TEXT NOT NULL UNIQUE,\n    dataset TEXT NOT NULL,\n    venue TEXT\n);\n</code></pre> <p>This creates a table called <code>publishers</code> with four columns. Every column has a data type that specifies what kind of values it can hold. <code>NULL</code> is a special value meaning \"no data\" or \"unknown\". <code>NOT NULL</code> is a constraint that specifies that a column must not contain NULL values.</p>"},{"location":"sql_primer/#primary-keys","title":"Primary Keys","text":"<p>A primary key is a column (or combination of columns) that uniquely identifies each row in a table. No two rows can have the same primary key value, and the primary key cannot be NULL.</p> <pre><code>publisher_id INTEGER PRIMARY KEY\n</code></pre> <p>When a column is declared as <code>INTEGER PRIMARY KEY</code> in SQLite, it becomes an auto-incrementing identifier\u2014if no value is specified during insertion, SQLite automatically assigns the next available number. Primary keys guarantee each row can be individually identified, and SQLite automatically creates an efficient lookup structure for primary key columns.</p>"},{"location":"sql_primer/#foreign-keys","title":"Foreign Keys","text":"<p>A foreign key is a column that references the primary key of another table, creating a relationship between the tables.</p> <pre><code>CREATE TABLE instruments (\n    instrument_id INTEGER PRIMARY KEY,\n    publisher_id INTEGER NOT NULL,\n    ...\n    FOREIGN KEY (publisher_id) REFERENCES publishers(publisher_id)\n);\n</code></pre> <p>This declaration means the <code>publisher_id</code> column in the <code>instruments</code> table must contain a value that exists in the <code>publisher_id</code> column of the <code>publishers</code> table. Foreign keys enforce referential integrity\u2014preventing the creation of an instrument that references a non-existent publisher, or the deletion of a publisher that still has instruments associated with it.</p>"},{"location":"sql_primer/#constraints","title":"Constraints","text":"<p>Constraints are rules that limit what data can be stored in a column. <code>NOT NULL</code> means the column must have a value. <code>UNIQUE</code> means no two rows can have the same value in this column. <code>DEFAULT</code> specifies a fallback value if none is provided during insertion. Constraints can also span multiple columns:</p> <pre><code>UNIQUE(publisher_id, raw_symbol)\n</code></pre> <p>This means the combination of publisher_id and raw_symbol must be unique. The same symbol (like 'ESH5') can appear multiple times in the table, as long as each occurrence is from a different publisher.</p>"},{"location":"sql_primer/#indexes","title":"Indexes","text":"<p>An index is a data structure that speeds up searches on specific columns\u2014like the index at the back of a book that allows jumping directly to a topic instead of reading every page.</p> <pre><code>CREATE INDEX idx_instruments_symbol ON instruments(raw_symbol);\n</code></pre> <p>This creates an index named <code>idx_instruments_symbol</code> on the <code>raw_symbol</code> column of the <code>instruments</code> table. When searching for instruments by symbol, the database can find them quickly without scanning every row.</p>"},{"location":"sql_primer/#normalization","title":"Normalization","text":"<p>The schema uses separate <code>publishers</code> and <code>instruments</code> tables rather than storing publisher names directly in each instrument row. This design principle is called normalization. Without it, publisher information would be duplicated in every row, wasting storage, creating update anomalies (changing a dataset name requires updating every row), and risking inconsistency from typos. With normalization, publisher information is stored once, and each instrument stores only a reference (the publisher_id) to the publisher.</p>"},{"location":"sql_primer/#one-to-many-relationships","title":"One-to-Many Relationships","text":"<p>The relationship between publishers and instruments is called one-to-many: one publisher can have many instruments, but each instrument belongs to exactly one publisher. This is implemented through the foreign key: <code>instruments.publisher_id</code> references <code>publishers.publisher_id</code>. Similarly, the relationship between instruments and OHLCV bars is one-to-many: one instrument can have millions of bars, but each bar belongs to exactly one instrument.</p> <pre><code>publishers (1) \u2500\u2500\u2500\u2500\u2500\u2500&lt; instruments (many) \u2500\u2500\u2500\u2500\u2500\u2500&lt; ohlcv (many)\n</code></pre>"},{"location":"sql_primer/#composite-primary-keys","title":"Composite Primary Keys","text":"<p>Sometimes a single column isn't enough to uniquely identify a row. The <code>ohlcv</code> table uses a composite primary key\u2014a primary key made up of multiple columns:</p> <pre><code>PRIMARY KEY (instrument_id, rtype, ts_event)\n</code></pre> <p>This means the combination of these three values must be unique\u2014multiple bars for the same instrument with different timestamps, multiple bars at the same timestamp for different instruments, and multiple bar types for the same instrument and time are all allowed, but two rows with the same instrument_id, rtype, AND ts_event would be a duplicate bar.</p>"},{"location":"sql_primer/#b-trees","title":"B-trees","text":"<p>A B-tree (balanced tree) is the data structure that databases use to organize data for fast lookups. It works like searching a phone book\u2014instead of reading every name from page 1, the search opens to the middle, determines which half contains the target, and repeats until the entry is found. Each step eliminates half the remaining possibilities. A B-tree organizes data into a tree structure with a root node at the top, branch nodes that guide the search, and leaf nodes containing the actual data. Finding one row among a billion takes the same number of steps as finding one among a thousand.</p>"},{"location":"sql_primer/#how-indexes-work","title":"How Indexes Work","text":"<p>When a table is created with a primary key, SQLite automatically creates a B-tree index for that key. Additional indexes created with <code>CREATE INDEX</code> are additional B-trees. Each index stores the indexed column value(s) and a pointer to the full row. When searching by an indexed column, the database searches the index B-tree (fast\u2014logarithmic time) and follows the pointer to retrieve the full row. Without an index, the database must perform a full table scan\u2014reading every row to find matches.</p>"},{"location":"sql_primer/#the-leftmost-prefix-rule","title":"The Leftmost Prefix Rule","text":"<p>For composite indexes (indexes on multiple columns), the index can only be used efficiently if the query filters on a leftmost prefix of the indexed columns. The <code>ohlcv</code> table has a primary key of <code>(instrument_id, rtype, ts_event)</code>, creating a B-tree sorted first by instrument_id, then by rtype within each instrument, then by ts_event within each rtype. Queries filtering on <code>instrument_id</code> alone, or <code>instrument_id AND rtype</code>, or all three columns can use this index efficiently. However, queries filtering only on <code>ts_event</code> or only on <code>rtype</code> cannot use the primary key index because they skip the leftmost column(s)\u2014the B-tree is sorted by instrument_id first. This is why the schema includes a separate index on <code>ts_event</code>:</p> <pre><code>CREATE INDEX idx_ohlcv_ts ON ohlcv(ts_event);\n</code></pre> <p>This creates a second B-tree sorted by timestamp, enabling fast time-based queries across all instruments.</p>"},{"location":"sql_primer/#without-rowid-tables","title":"WITHOUT ROWID Tables","text":"<p>In a normal SQLite table, data is stored in a B-tree organized by an internal rowid (a hidden auto-incrementing integer). If a primary key is defined, SQLite creates a second B-tree for that key, which stores the primary key values and their corresponding rowids. Looking up a row by primary key requires searching the primary key B-tree to find the rowid, then searching the rowid B-tree to find the actual data. This double lookup is fine for most tables, but for a table with billions of rows accessed primarily by its composite key (like <code>ohlcv</code>), it's wasteful.</p> <p>The <code>WITHOUT ROWID</code> optimization changes this:</p> <pre><code>CREATE TABLE ohlcv (\n    ...\n    PRIMARY KEY (instrument_id, rtype, ts_event)\n) WITHOUT ROWID;\n</code></pre> <p>Now the table data is stored directly in the primary key B-tree. There's no separate rowid B-tree, no double lookup\u2014resulting in ~50% storage reduction (primary key values aren't stored twice), faster lookups (one B-tree search instead of two), and better locality (data for the same instrument is physically adjacent on disk). The tradeoff is that WITHOUT ROWID tables can't use some SQLite optimizations that depend on rowids, but for time-series data accessed by composite key, this is the right choice.</p>"},{"location":"sql_primer/#index-tradeoffs","title":"Index Tradeoffs","text":"<p>Indexes aren't free\u2014each index consumes storage, slows down writes (every INSERT must update all indexes), and requires maintenance to stay in sync with data. The schema includes only two additional indexes beyond the primary keys: <code>idx_ohlcv_ts</code> on <code>ohlcv(ts_event)</code> to enable time-range queries across instruments, and <code>idx_instruments_symbol</code> on <code>instruments(raw_symbol)</code> to enable symbol lookups. Each was added because the query pattern it supports is common enough to justify the overhead.</p>"},{"location":"api-reference/overview/","title":"API Reference","text":"<ul> <li> <p>Connectors </p> <p> View <code>connectors</code> package API</p> </li> <li> <p>Core </p> <p> View <code>core</code> package API</p> </li> <li> <p>Secmaster </p> <p> View <code>secmaster</code> package API</p> </li> </ul>"},{"location":"api-reference/connectors/brokers/simulated/","title":"Simulated","text":""},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated._PendingOrder","title":"<code>_PendingOrder</code>  <code>dataclass</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>@dataclasses.dataclass\nclass _PendingOrder:\n    # Order state tracked by the broker, distinct from the OrderSubmission event\n    order_id: uuid.UUID\n    symbol: str\n    order_type: models.OrderType\n    side: models.OrderSide\n    quantity: float\n    limit_price: float | None = None\n    stop_price: float | None = None\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker","title":"<code>SimulatedBroker</code>","text":"<p>               Bases: <code>BrokerBase</code></p>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker.__init__","title":"<code>__init__(event_bus)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def __init__(self, event_bus: messaging.EventBus) -&gt; None:\n    self._pending_market_orders: dict[uuid.UUID, _PendingOrder] = {}\n    self._pending_limit_orders: dict[uuid.UUID, _PendingOrder] = {}\n    self._pending_stop_orders: dict[uuid.UUID, _PendingOrder] = {}\n    self._pending_stop_limit_orders: dict[uuid.UUID, _PendingOrder] = {}\n\n    super().__init__(event_bus)\n    self._subscribe(events.BarReceived)\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._on_event","title":"<code>_on_event(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _on_event(self, event: events.EventBase) -&gt; None:\n    match event:\n        case events.BarReceived() as bar:\n            self._on_bar(bar)\n        case _:\n            super()._on_event(event)\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._on_bar","title":"<code>_on_bar(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _on_bar(self, event: events.BarReceived) -&gt; None:\n    self._process_market_orders(event)\n    self._process_stop_orders(event)\n    self._process_stop_limit_orders(event)\n    self._process_limit_orders(event)\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._process_market_orders","title":"<code>_process_market_orders(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _process_market_orders(self, event: events.BarReceived) -&gt; None:\n    for order_id, order in list(self._pending_market_orders.items()):\n        if order.symbol != event.symbol:\n            continue\n\n        self._publish(\n            events.OrderFilled(\n                ts_event=event.ts_event,\n                ts_broker=event.ts_event,\n                associated_order_id=order.order_id,\n                symbol=order.symbol,\n                side=order.side,\n                quantity_filled=order.quantity,\n                fill_price=event.open,\n                commission=max(\n                    order.quantity * self.commission_per_unit,\n                    self.minimum_commission_per_order,\n                ),\n            )\n        )\n        del self._pending_market_orders[order_id]\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._process_stop_orders","title":"<code>_process_stop_orders(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _process_stop_orders(self, event: events.BarReceived) -&gt; None:\n    for order_id, order in list(self._pending_stop_orders.items()):\n        if order.symbol != event.symbol:\n            continue\n\n        # This is for mypy, it has already been validated on submission\n        assert order.stop_price is not None\n\n        triggered = False\n        match order.side:\n            case models.OrderSide.BUY:\n                triggered = event.high &gt;= order.stop_price\n            case models.OrderSide.SELL:\n                triggered = event.low &lt;= order.stop_price\n\n        if not triggered:\n            continue\n\n        fill_price = 0.0\n        match order.side:\n            case models.OrderSide.BUY:\n                fill_price = max(order.stop_price, event.open)\n            case models.OrderSide.SELL:\n                fill_price = min(order.stop_price, event.open)\n\n        self._publish(\n            events.OrderFilled(\n                ts_event=event.ts_event,\n                ts_broker=event.ts_event,\n                associated_order_id=order.order_id,\n                symbol=order.symbol,\n                side=order.side,\n                quantity_filled=order.quantity,\n                fill_price=fill_price,\n                commission=max(\n                    order.quantity * self.commission_per_unit,\n                    self.minimum_commission_per_order,\n                ),\n            )\n        )\n        del self._pending_stop_orders[order_id]\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._process_stop_limit_orders","title":"<code>_process_stop_limit_orders(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _process_stop_limit_orders(self, event: events.BarReceived) -&gt; None:\n    for order_id, order in list(self._pending_stop_limit_orders.items()):\n        if order.symbol != event.symbol:\n            continue\n\n        # This is for mypy, it has already been validated on submission\n        assert order.stop_price is not None\n\n        triggered = False\n        match order.side:\n            case models.OrderSide.BUY:\n                triggered = event.high &gt;= order.stop_price\n            case models.OrderSide.SELL:\n                triggered = event.low &lt;= order.stop_price\n\n        if not triggered:\n            continue\n\n        limit_order = dataclasses.replace(order, order_type=models.OrderType.LIMIT)\n        self._pending_limit_orders[order_id] = limit_order\n        del self._pending_stop_limit_orders[order_id]\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._process_limit_orders","title":"<code>_process_limit_orders(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _process_limit_orders(self, event: events.BarReceived) -&gt; None:\n    for order_id, order in list(self._pending_limit_orders.items()):\n        if order.symbol != event.symbol:\n            continue\n\n        # This is for mypy, it has already been validated on submission\n        assert order.limit_price is not None\n\n        triggered = False\n        match order.side:\n            case models.OrderSide.BUY:\n                triggered = event.low &lt;= order.limit_price\n            case models.OrderSide.SELL:\n                triggered = event.high &gt;= order.limit_price\n\n        if not triggered:\n            continue\n\n        fill_price = 0.0\n        match order.side:\n            case models.OrderSide.BUY:\n                fill_price = min(order.limit_price, event.open)\n            case models.OrderSide.SELL:\n                fill_price = max(order.limit_price, event.open)\n\n        self._publish(\n            events.OrderFilled(\n                ts_event=event.ts_event,\n                ts_broker=event.ts_event,\n                associated_order_id=order.order_id,\n                symbol=order.symbol,\n                side=order.side,\n                quantity_filled=order.quantity,\n                fill_price=fill_price,\n                commission=max(\n                    order.quantity * self.commission_per_unit,\n                    self.minimum_commission_per_order,\n                ),\n            )\n        )\n        del self._pending_limit_orders[order_id]\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._reject_if_invalid_submission","title":"<code>_reject_if_invalid_submission(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _reject_if_invalid_submission(self, event: events.OrderSubmission) -&gt; bool:\n    is_invalid = event.quantity &lt;= 0\n\n    match event.order_type:\n        case models.OrderType.LIMIT:\n            is_invalid = (\n                is_invalid or event.limit_price is None or event.limit_price &lt;= 0\n            )\n        case models.OrderType.STOP:\n            is_invalid = (\n                is_invalid or event.stop_price is None or event.stop_price &lt;= 0\n            )\n        case models.OrderType.STOP_LIMIT:\n            is_invalid = is_invalid or (\n                event.limit_price is None\n                or event.limit_price &lt;= 0\n                or event.stop_price is None\n                or event.stop_price &lt;= 0\n            )\n\n    if is_invalid:\n        # Use event timestamp to maintain simulated time consistency in backtesting\n        self._publish(\n            events.OrderSubmissionRejected(\n                ts_event=event.ts_event,\n                ts_broker=event.ts_event,\n                associated_order_id=event.system_order_id,\n            )\n        )\n\n    return is_invalid\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._on_submit_order","title":"<code>_on_submit_order(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _on_submit_order(self, event: events.OrderSubmission) -&gt; None:\n    if self._reject_if_invalid_submission(event):\n        return\n\n    order = _PendingOrder(\n        order_id=event.system_order_id,\n        symbol=event.symbol,\n        order_type=event.order_type,\n        side=event.side,\n        quantity=event.quantity,\n        limit_price=event.limit_price,\n        stop_price=event.stop_price,\n    )\n\n    match order.order_type:\n        case models.OrderType.MARKET:\n            self._pending_market_orders[order.order_id] = order\n        case models.OrderType.LIMIT:\n            self._pending_limit_orders[order.order_id] = order\n        case models.OrderType.STOP:\n            self._pending_stop_orders[order.order_id] = order\n        case models.OrderType.STOP_LIMIT:\n            self._pending_stop_limit_orders[order.order_id] = order\n\n    # Use event timestamp to maintain simulated time consistency in backtesting\n    self._publish(\n        events.OrderSubmissionAccepted(\n            ts_event=event.ts_event,\n            ts_broker=event.ts_event,\n            associated_order_id=order.order_id,\n        )\n    )\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._on_cancel_order","title":"<code>_on_cancel_order(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _on_cancel_order(self, event: events.OrderCancellation) -&gt; None:\n    order_id = event.system_order_id\n\n    removed = False\n    for pending_orders in (\n        self._pending_market_orders,\n        self._pending_limit_orders,\n        self._pending_stop_orders,\n        self._pending_stop_limit_orders,\n    ):\n        if order_id in pending_orders:\n            del pending_orders[order_id]\n            removed = True\n            break\n\n    # Use event timestamp to maintain simulated time consistency in backtesting\n    if removed:\n        self._publish(\n            events.OrderCancellationAccepted(\n                ts_event=event.ts_event,\n                ts_broker=event.ts_event,\n                associated_order_id=order_id,\n            )\n        )\n    else:\n        self._publish(\n            events.OrderCancellationRejected(\n                ts_event=event.ts_event,\n                ts_broker=event.ts_event,\n                associated_order_id=order_id,\n            )\n        )\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._reject_if_invalid_modification","title":"<code>_reject_if_invalid_modification(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _reject_if_invalid_modification(self, event: events.OrderModification) -&gt; bool:\n    is_invalid = (\n        (event.quantity is not None and event.quantity &lt;= 0)\n        or (event.limit_price is not None and event.limit_price &lt;= 0)\n        or (event.stop_price is not None and event.stop_price &lt;= 0)\n    )\n\n    if is_invalid:\n        # Use event timestamp to maintain simulated time consistency in backtesting\n        self._publish(\n            events.OrderModificationRejected(\n                ts_event=event.ts_event,\n                ts_broker=event.ts_event,\n                associated_order_id=event.system_order_id,\n            )\n        )\n\n    return is_invalid\n</code></pre>"},{"location":"api-reference/connectors/brokers/simulated/#onesecondtrader.connectors.brokers.simulated.SimulatedBroker._on_modify_order","title":"<code>_on_modify_order(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/brokers/simulated.py</code> <pre><code>def _on_modify_order(self, event: events.OrderModification) -&gt; None:\n    if self._reject_if_invalid_modification(event):\n        return\n\n    order_id = event.system_order_id\n\n    for pending_orders in (\n        self._pending_market_orders,\n        self._pending_limit_orders,\n        self._pending_stop_orders,\n        self._pending_stop_limit_orders,\n    ):\n        if order_id in pending_orders:\n            order = pending_orders[order_id]\n\n            new_quantity = (\n                event.quantity if event.quantity is not None else order.quantity\n            )\n            new_limit_price = (\n                event.limit_price\n                if event.limit_price is not None\n                else order.limit_price\n            )\n            new_stop_price = (\n                event.stop_price\n                if event.stop_price is not None\n                else order.stop_price\n            )\n\n            pending_orders[order_id] = dataclasses.replace(\n                order,\n                quantity=new_quantity,\n                limit_price=new_limit_price,\n                stop_price=new_stop_price,\n            )\n\n            # Use event timestamp to maintain simulated time consistency in backtesting\n            self._publish(\n                events.OrderModificationAccepted(\n                    ts_event=event.ts_event,\n                    ts_broker=event.ts_event,\n                    associated_order_id=order_id,\n                )\n            )\n            return\n\n    # Use event timestamp to maintain simulated time consistency in backtesting\n    self._publish(\n        events.OrderModificationRejected(\n            ts_event=event.ts_event,\n            ts_broker=event.ts_event,\n            associated_order_id=order_id,\n        )\n    )\n</code></pre>"},{"location":"api-reference/connectors/datafeeds/base/","title":"Base","text":""},{"location":"api-reference/connectors/datafeeds/base/#onesecondtrader.connectors.datafeeds.base.Datafeed","title":"<code>Datafeed</code>","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"api-reference/connectors/datafeeds/base/#onesecondtrader.connectors.datafeeds.base.Datafeed.__init__","title":"<code>__init__(event_bus)</code>","text":"Source code in <code>src/onesecondtrader/connectors/datafeeds/base.py</code> <pre><code>def __init__(self, event_bus: messaging.EventBus) -&gt; None:\n    self._event_bus = event_bus\n</code></pre>"},{"location":"api-reference/connectors/datafeeds/base/#onesecondtrader.connectors.datafeeds.base.Datafeed._publish","title":"<code>_publish(event)</code>","text":"Source code in <code>src/onesecondtrader/connectors/datafeeds/base.py</code> <pre><code>def _publish(self, event: events.EventBase) -&gt; None:\n    self._event_bus.publish(event)\n</code></pre>"},{"location":"api-reference/connectors/datafeeds/base/#onesecondtrader.connectors.datafeeds.base.Datafeed.stream","title":"<code>stream(symbols, bar_period)</code>  <code>abstractmethod</code>","text":"Source code in <code>src/onesecondtrader/connectors/datafeeds/base.py</code> <pre><code>@abc.abstractmethod\ndef stream(self, symbols: list[str], bar_period: models.BarPeriod) -&gt; None:\n    pass\n</code></pre>"},{"location":"api-reference/connectors/datafeeds/base/#onesecondtrader.connectors.datafeeds.base.Datafeed.shutdown","title":"<code>shutdown()</code>  <code>abstractmethod</code>","text":"Source code in <code>src/onesecondtrader/connectors/datafeeds/base.py</code> <pre><code>@abc.abstractmethod\ndef shutdown(self) -&gt; None:\n    pass\n</code></pre>"},{"location":"api-reference/connectors/datafeeds/simulated/","title":"Simulated","text":""},{"location":"api-reference/connectors/datafeeds/simulated/#onesecondtrader.connectors.datafeeds.simulated._RTYPE_MAP","title":"<code>_RTYPE_MAP = {models.BarPeriod.SECOND: 32, models.BarPeriod.MINUTE: 33, models.BarPeriod.HOUR: 34, models.BarPeriod.DAY: 35}</code>  <code>module-attribute</code>","text":""},{"location":"api-reference/connectors/datafeeds/simulated/#onesecondtrader.connectors.datafeeds.simulated.SimulatedDatafeed","title":"<code>SimulatedDatafeed</code>","text":"<p>               Bases: <code>Datafeed</code></p>"},{"location":"api-reference/connectors/datafeeds/simulated/#onesecondtrader.connectors.datafeeds.simulated.SimulatedDatafeed.__init__","title":"<code>__init__(event_bus)</code>","text":"Source code in <code>src/onesecondtrader/connectors/datafeeds/simulated.py</code> <pre><code>def __init__(self, event_bus: messaging.EventBus) -&gt; None:\n    super().__init__(event_bus)\n    self._thread: threading.Thread | None = None\n    self._stop_event = threading.Event()\n</code></pre>"},{"location":"api-reference/connectors/datafeeds/simulated/#onesecondtrader.connectors.datafeeds.simulated.SimulatedDatafeed.stream","title":"<code>stream(symbols, bar_period)</code>","text":"Source code in <code>src/onesecondtrader/connectors/datafeeds/simulated.py</code> <pre><code>def stream(self, symbols: list[str], bar_period: models.BarPeriod) -&gt; None:\n    csv_path = pathlib.Path(self.csv_path)\n    if self._thread and self._thread.is_alive():\n        raise RuntimeError(\"Already streaming\")\n    if not csv_path.exists():\n        raise FileNotFoundError(f\"CSV file not found: {csv_path}\")\n    if not symbols:\n        raise ValueError(\"symbols list cannot be empty\")\n\n    self._stop_event.clear()\n    self._thread = threading.Thread(\n        target=self._stream,\n        args=(symbols, bar_period),\n        name=self.__class__.__name__,\n        daemon=False,\n    )\n    self._thread.start()\n</code></pre>"},{"location":"api-reference/connectors/datafeeds/simulated/#onesecondtrader.connectors.datafeeds.simulated.SimulatedDatafeed.wait","title":"<code>wait()</code>","text":"Source code in <code>src/onesecondtrader/connectors/datafeeds/simulated.py</code> <pre><code>def wait(self) -&gt; None:\n    if self._thread:\n        self._thread.join()\n</code></pre>"},{"location":"api-reference/connectors/datafeeds/simulated/#onesecondtrader.connectors.datafeeds.simulated.SimulatedDatafeed.shutdown","title":"<code>shutdown()</code>","text":"Source code in <code>src/onesecondtrader/connectors/datafeeds/simulated.py</code> <pre><code>def shutdown(self) -&gt; None:\n    self._stop_event.set()\n    if self._thread and self._thread.is_alive():\n        self._thread.join()\n</code></pre>"},{"location":"api-reference/connectors/datafeeds/simulated/#onesecondtrader.connectors.datafeeds.simulated.SimulatedDatafeed._stream","title":"<code>_stream(symbols, bar_period)</code>","text":"Source code in <code>src/onesecondtrader/connectors/datafeeds/simulated.py</code> <pre><code>def _stream(self, symbols: list[str], bar_period: models.BarPeriod) -&gt; None:\n    symbols_set = set(symbols)\n    rtype = _RTYPE_MAP[bar_period]\n\n    for chunk in pd.read_csv(\n        self.csv_path,\n        usecols=[\n            \"ts_event\",\n            \"rtype\",\n            \"open\",\n            \"high\",\n            \"low\",\n            \"close\",\n            \"volume\",\n            \"symbol\",\n        ],\n        dtype={\n            \"ts_event\": int,\n            \"rtype\": int,\n            \"open\": int,\n            \"high\": int,\n            \"low\": int,\n            \"close\": int,\n            \"volume\": int,\n            \"symbol\": str,\n        },\n        chunksize=10_000,\n    ):\n        for row in chunk.itertuples():\n            if self._stop_event.is_set():\n                return\n\n            if row.symbol not in symbols_set or row.rtype != rtype:\n                continue\n\n            self._publish(\n                events.BarReceived(\n                    ts_event=pd.Timestamp(row.ts_event, unit=\"ns\", tz=\"UTC\"),\n                    symbol=row.symbol,\n                    bar_period=bar_period,\n                    open=row.open / 1e9,\n                    high=row.high / 1e9,\n                    low=row.low / 1e9,\n                    close=row.close / 1e9,\n                    volume=row.volume,\n                )\n            )\n            self._event_bus.wait_until_system_idle()\n</code></pre>"},{"location":"api-reference/core/brokers/base/","title":"Base","text":""},{"location":"api-reference/core/brokers/base/#onesecondtrader.core.brokers.base.BrokerBase","title":"<code>BrokerBase</code>","text":"<p>               Bases: <code>Subscriber</code></p>"},{"location":"api-reference/core/brokers/base/#onesecondtrader.core.brokers.base.BrokerBase.__init__","title":"<code>__init__(event_bus)</code>","text":"Source code in <code>src/onesecondtrader/core/brokers/base.py</code> <pre><code>def __init__(self, event_bus: messaging.EventBus) -&gt; None:\n    super().__init__(event_bus)\n    self._subscribe(\n        events.requests.OrderSubmission,\n        events.requests.OrderCancellation,\n        events.requests.OrderModification,\n    )\n</code></pre>"},{"location":"api-reference/core/brokers/base/#onesecondtrader.core.brokers.base.BrokerBase._on_event","title":"<code>_on_event(event)</code>","text":"Source code in <code>src/onesecondtrader/core/brokers/base.py</code> <pre><code>def _on_event(self, event: events.bases.EventBase) -&gt; None:\n    match event:\n        case events.requests.OrderSubmission() as submit_order:\n            self._on_submit_order(submit_order)\n        case events.requests.OrderCancellation() as cancel_order:\n            self._on_cancel_order(cancel_order)\n        case events.requests.OrderModification() as modify_order:\n            self._on_modify_order(modify_order)\n        case _:\n            return\n</code></pre>"},{"location":"api-reference/core/brokers/base/#onesecondtrader.core.brokers.base.BrokerBase._on_submit_order","title":"<code>_on_submit_order(event)</code>  <code>abstractmethod</code>","text":"Source code in <code>src/onesecondtrader/core/brokers/base.py</code> <pre><code>@abc.abstractmethod\ndef _on_submit_order(self, event: events.requests.OrderSubmission) -&gt; None:\n    pass\n</code></pre>"},{"location":"api-reference/core/brokers/base/#onesecondtrader.core.brokers.base.BrokerBase._on_cancel_order","title":"<code>_on_cancel_order(event)</code>  <code>abstractmethod</code>","text":"Source code in <code>src/onesecondtrader/core/brokers/base.py</code> <pre><code>@abc.abstractmethod\ndef _on_cancel_order(self, event: events.requests.OrderCancellation) -&gt; None:\n    pass\n</code></pre>"},{"location":"api-reference/core/brokers/base/#onesecondtrader.core.brokers.base.BrokerBase._on_modify_order","title":"<code>_on_modify_order(event)</code>  <code>abstractmethod</code>","text":"Source code in <code>src/onesecondtrader/core/brokers/base.py</code> <pre><code>@abc.abstractmethod\ndef _on_modify_order(self, event: events.requests.OrderModification) -&gt; None:\n    pass\n</code></pre>"},{"location":"api-reference/core/brokers/base/#onesecondtrader.core.brokers.base.BrokerBase._respond","title":"<code>_respond(response_event)</code>","text":"Source code in <code>src/onesecondtrader/core/brokers/base.py</code> <pre><code>def _respond(self, response_event: events.bases.BrokerResponseEvent) -&gt; None:\n    self._publish(response_event)\n</code></pre>"},{"location":"api-reference/core/events/bases/","title":"Bases","text":""},{"location":"api-reference/core/events/bases/#onesecondtrader.core.events.bases.EventBase","title":"<code>EventBase</code>  <code>dataclass</code>","text":"Source code in <code>src/onesecondtrader/core/events/bases.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass EventBase:\n    ts_event: pd.Timestamp\n    ts_created: pd.Timestamp = dataclasses.field(\n        default_factory=lambda: pd.Timestamp.now(tz=\"UTC\")\n    )\n</code></pre>"},{"location":"api-reference/core/events/bases/#onesecondtrader.core.events.bases.MarketEvent","title":"<code>MarketEvent</code>  <code>dataclass</code>","text":"<p>               Bases: <code>EventBase</code></p> Source code in <code>src/onesecondtrader/core/events/bases.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass MarketEvent(EventBase):\n    pass\n</code></pre>"},{"location":"api-reference/core/events/bases/#onesecondtrader.core.events.bases.BrokerRequestEvent","title":"<code>BrokerRequestEvent</code>  <code>dataclass</code>","text":"<p>               Bases: <code>EventBase</code></p> Source code in <code>src/onesecondtrader/core/events/bases.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass BrokerRequestEvent(EventBase):\n    system_order_id: uuid.UUID\n</code></pre>"},{"location":"api-reference/core/events/bases/#onesecondtrader.core.events.bases.BrokerResponseEvent","title":"<code>BrokerResponseEvent</code>  <code>dataclass</code>","text":"<p>               Bases: <code>EventBase</code></p> Source code in <code>src/onesecondtrader/core/events/bases.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass BrokerResponseEvent(EventBase):\n    ts_broker: pd.Timestamp\n    associated_order_id: uuid.UUID\n</code></pre>"},{"location":"api-reference/core/events/market/","title":"Market","text":""},{"location":"api-reference/core/events/market/#onesecondtrader.core.events.market.BarReceived","title":"<code>BarReceived</code>  <code>dataclass</code>","text":"<p>               Bases: <code>MarketEvent</code></p> Source code in <code>src/onesecondtrader/core/events/market.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass BarReceived(bases.MarketEvent):\n    symbol: str\n    bar_period: models.data.BarPeriod\n    open: float\n    high: float\n    low: float\n    close: float\n    volume: int | None = None\n</code></pre>"},{"location":"api-reference/core/events/market/#onesecondtrader.core.events.market.BarProcessed","title":"<code>BarProcessed</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BarReceived</code></p> Source code in <code>src/onesecondtrader/core/events/market.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass BarProcessed(BarReceived):\n    indicators: dict[str, float] = dataclasses.field(default_factory=dict)\n</code></pre>"},{"location":"api-reference/core/events/requests/","title":"Requests","text":""},{"location":"api-reference/core/events/requests/#onesecondtrader.core.events.requests.OrderSubmission","title":"<code>OrderSubmission</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerRequestEvent</code></p> Source code in <code>src/onesecondtrader/core/events/requests.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderSubmission(bases.BrokerRequestEvent):\n    system_order_id: uuid.UUID = dataclasses.field(default_factory=uuid.uuid4)\n    symbol: str\n    order_type: models.orders.OrderType\n    side: models.orders.OrderSide\n    quantity: float\n    limit_price: float | None = None\n    stop_price: float | None = None\n</code></pre>"},{"location":"api-reference/core/events/requests/#onesecondtrader.core.events.requests.OrderCancellation","title":"<code>OrderCancellation</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerRequestEvent</code></p> Source code in <code>src/onesecondtrader/core/events/requests.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderCancellation(bases.BrokerRequestEvent):\n    symbol: str\n</code></pre>"},{"location":"api-reference/core/events/requests/#onesecondtrader.core.events.requests.OrderModification","title":"<code>OrderModification</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerRequestEvent</code></p> Source code in <code>src/onesecondtrader/core/events/requests.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderModification(bases.BrokerRequestEvent):\n    symbol: str\n    quantity: float | None = None\n    limit_price: float | None = None\n    stop_price: float | None = None\n</code></pre>"},{"location":"api-reference/core/events/responses/","title":"Responses","text":""},{"location":"api-reference/core/events/responses/#onesecondtrader.core.events.responses.OrderSubmissionAccepted","title":"<code>OrderSubmissionAccepted</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerResponseEvent</code></p> Source code in <code>src/onesecondtrader/core/events/responses.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderSubmissionAccepted(bases.BrokerResponseEvent):\n    broker_order_id: str | None = None\n</code></pre>"},{"location":"api-reference/core/events/responses/#onesecondtrader.core.events.responses.OrderSubmissionRejected","title":"<code>OrderSubmissionRejected</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerResponseEvent</code></p> Source code in <code>src/onesecondtrader/core/events/responses.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderSubmissionRejected(bases.BrokerResponseEvent):\n    reason: str | None = None\n</code></pre>"},{"location":"api-reference/core/events/responses/#onesecondtrader.core.events.responses.OrderModificationAccepted","title":"<code>OrderModificationAccepted</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerResponseEvent</code></p> Source code in <code>src/onesecondtrader/core/events/responses.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderModificationAccepted(bases.BrokerResponseEvent):\n    broker_order_id: str | None = None\n</code></pre>"},{"location":"api-reference/core/events/responses/#onesecondtrader.core.events.responses.OrderModificationRejected","title":"<code>OrderModificationRejected</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerResponseEvent</code></p> Source code in <code>src/onesecondtrader/core/events/responses.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderModificationRejected(bases.BrokerResponseEvent):\n    reason: str | None = None\n</code></pre>"},{"location":"api-reference/core/events/responses/#onesecondtrader.core.events.responses.OrderCancellationAccepted","title":"<code>OrderCancellationAccepted</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerResponseEvent</code></p> Source code in <code>src/onesecondtrader/core/events/responses.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderCancellationAccepted(bases.BrokerResponseEvent):\n    pass\n</code></pre>"},{"location":"api-reference/core/events/responses/#onesecondtrader.core.events.responses.OrderCancellationRejected","title":"<code>OrderCancellationRejected</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerResponseEvent</code></p> Source code in <code>src/onesecondtrader/core/events/responses.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderCancellationRejected(bases.BrokerResponseEvent):\n    reason: str | None = None\n</code></pre>"},{"location":"api-reference/core/events/responses/#onesecondtrader.core.events.responses.OrderFilled","title":"<code>OrderFilled</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerResponseEvent</code></p> Source code in <code>src/onesecondtrader/core/events/responses.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderFilled(bases.BrokerResponseEvent):\n    fill_id: uuid.UUID = dataclasses.field(default_factory=uuid.uuid4)\n    broker_fill_id: str | None = None\n    symbol: str\n    side: models.orders.OrderSide\n    quantity_filled: float\n    fill_price: float\n    commission: float\n    exchange: str = \"SIMULATED\"\n</code></pre>"},{"location":"api-reference/core/events/responses/#onesecondtrader.core.events.responses.OrderExpired","title":"<code>OrderExpired</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BrokerResponseEvent</code></p> Source code in <code>src/onesecondtrader/core/events/responses.py</code> <pre><code>@dataclasses.dataclass(kw_only=True, frozen=True)\nclass OrderExpired(bases.BrokerResponseEvent):\n    pass\n</code></pre>"},{"location":"api-reference/core/indicators/averages/","title":"Averages","text":""},{"location":"api-reference/core/indicators/averages/#onesecondtrader.core.indicators.averages.SimpleMovingAverage","title":"<code>SimpleMovingAverage</code>","text":"<p>               Bases: <code>Indicator</code></p> Source code in <code>src/onesecondtrader/core/indicators/averages.py</code> <pre><code>def name(self) -&gt; str:\n    return f\"SMA_{self.period}_{self.input_source.name}\"\n</code></pre>"},{"location":"api-reference/core/indicators/averages/#onesecondtrader.core.indicators.averages.SimpleMovingAverage.name","title":"<code>name</code>  <code>property</code>","text":""},{"location":"api-reference/core/indicators/averages/#onesecondtrader.core.indicators.averages.SimpleMovingAverage.__init__","title":"<code>__init__(period=200, max_history=100, input_source=models.InputSource.CLOSE, plot_at=0)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/averages.py</code> <pre><code>def __init__(\n    self,\n    period: int = 200,\n    max_history: int = 100,\n    input_source: models.InputSource = models.InputSource.CLOSE,\n    plot_at: int = 0,\n) -&gt; None:\n    super().__init__(max_history=max_history, plot_at=plot_at)\n    self.period: int = max(1, int(period))\n    self.input_source: models.InputSource = input_source\n    self._window: dict[str, collections.deque[float]] = {}\n</code></pre>"},{"location":"api-reference/core/indicators/averages/#onesecondtrader.core.indicators.averages.SimpleMovingAverage._compute_indicator","title":"<code>_compute_indicator(incoming_bar)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/averages.py</code> <pre><code>def _compute_indicator(self, incoming_bar: events.BarReceived) -&gt; float:\n    symbol = incoming_bar.symbol\n    if symbol not in self._window:\n        self._window[symbol] = collections.deque(maxlen=self.period)\n    window = self._window[symbol]\n    value = self._extract_input(incoming_bar)\n    window.append(value)\n    if len(window) &lt; self.period:\n        return np.nan\n    return sum(window) / self.period\n</code></pre>"},{"location":"api-reference/core/indicators/averages/#onesecondtrader.core.indicators.averages.SimpleMovingAverage._extract_input","title":"<code>_extract_input(incoming_bar)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/averages.py</code> <pre><code>def _extract_input(self, incoming_bar: events.BarReceived) -&gt; float:\n    match self.input_source:\n        case models.InputSource.OPEN:\n            return incoming_bar.open\n        case models.InputSource.HIGH:\n            return incoming_bar.high\n        case models.InputSource.LOW:\n            return incoming_bar.low\n        case models.InputSource.CLOSE:\n            return incoming_bar.close\n        case models.InputSource.VOLUME:\n            return (\n                float(incoming_bar.volume)\n                if incoming_bar.volume is not None\n                else np.nan\n            )\n        case _:\n            return incoming_bar.close\n</code></pre>"},{"location":"api-reference/core/indicators/bar/","title":"Bar","text":""},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Open","title":"<code>Open</code>","text":"<p>               Bases: <code>Indicator</code></p> Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def name(self) -&gt; str:\n    return \"OPEN\"\n</code></pre>"},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Open.name","title":"<code>name</code>  <code>property</code>","text":""},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Open._compute_indicator","title":"<code>_compute_indicator(incoming_bar)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def _compute_indicator(self, incoming_bar: events.BarReceived) -&gt; float:\n    return incoming_bar.open\n</code></pre>"},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.High","title":"<code>High</code>","text":"<p>               Bases: <code>Indicator</code></p> Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def name(self) -&gt; str:\n    return \"HIGH\"\n</code></pre>"},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.High.name","title":"<code>name</code>  <code>property</code>","text":""},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.High._compute_indicator","title":"<code>_compute_indicator(incoming_bar)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def _compute_indicator(self, incoming_bar: events.BarReceived) -&gt; float:\n    return incoming_bar.high\n</code></pre>"},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Low","title":"<code>Low</code>","text":"<p>               Bases: <code>Indicator</code></p> Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def name(self) -&gt; str:\n    return \"LOW\"\n</code></pre>"},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Low.name","title":"<code>name</code>  <code>property</code>","text":""},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Low._compute_indicator","title":"<code>_compute_indicator(incoming_bar)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def _compute_indicator(self, incoming_bar: events.BarReceived) -&gt; float:\n    return incoming_bar.low\n</code></pre>"},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Close","title":"<code>Close</code>","text":"<p>               Bases: <code>Indicator</code></p> Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def name(self) -&gt; str:\n    return \"CLOSE\"\n</code></pre>"},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Close.name","title":"<code>name</code>  <code>property</code>","text":""},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Close._compute_indicator","title":"<code>_compute_indicator(incoming_bar)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def _compute_indicator(self, incoming_bar: events.BarReceived) -&gt; float:\n    return incoming_bar.close\n</code></pre>"},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Volume","title":"<code>Volume</code>","text":"<p>               Bases: <code>Indicator</code></p> Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def name(self) -&gt; str:\n    return \"VOLUME\"\n</code></pre>"},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Volume.name","title":"<code>name</code>  <code>property</code>","text":""},{"location":"api-reference/core/indicators/bar/#onesecondtrader.core.indicators.bar.Volume._compute_indicator","title":"<code>_compute_indicator(incoming_bar)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/bar.py</code> <pre><code>def _compute_indicator(self, incoming_bar: events.BarReceived) -&gt; float:\n    return float(incoming_bar.volume) if incoming_bar.volume is not None else 0.0\n</code></pre>"},{"location":"api-reference/core/indicators/base/","title":"Base","text":""},{"location":"api-reference/core/indicators/base/#onesecondtrader.core.indicators.base.Indicator","title":"<code>Indicator</code>","text":"<p>               Bases: <code>ABC</code></p> Source code in <code>src/onesecondtrader/core/indicators/base.py</code> <pre><code>def name(self) -&gt; str:\n    pass\n</code></pre> Source code in <code>src/onesecondtrader/core/indicators/base.py</code> <pre><code>def latest(self) -&gt; float:\n    with self._lock:\n        h = self._history_data.get(self._current_symbol, collections.deque())\n        return h[-1] if h else np.nan\n</code></pre> Source code in <code>src/onesecondtrader/core/indicators/base.py</code> <pre><code>def history(self) -&gt; collections.deque[float]:\n    with self._lock:\n        h = self._history_data.get(self._current_symbol, collections.deque())\n        return collections.deque(h, maxlen=self._max_history)\n</code></pre> Source code in <code>src/onesecondtrader/core/indicators/base.py</code> <pre><code>def plot_at(self) -&gt; int:\n    return self._plot_at\n</code></pre>"},{"location":"api-reference/core/indicators/base/#onesecondtrader.core.indicators.base.Indicator.name","title":"<code>name</code>  <code>abstractmethod</code> <code>property</code>","text":""},{"location":"api-reference/core/indicators/base/#onesecondtrader.core.indicators.base.Indicator.latest","title":"<code>latest</code>  <code>property</code>","text":""},{"location":"api-reference/core/indicators/base/#onesecondtrader.core.indicators.base.Indicator.history","title":"<code>history</code>  <code>property</code>","text":""},{"location":"api-reference/core/indicators/base/#onesecondtrader.core.indicators.base.Indicator.plot_at","title":"<code>plot_at</code>  <code>property</code>","text":""},{"location":"api-reference/core/indicators/base/#onesecondtrader.core.indicators.base.Indicator.__init__","title":"<code>__init__(max_history=100, plot_at=99)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/base.py</code> <pre><code>def __init__(self, max_history: int = 100, plot_at: int = 99) -&gt; None:\n    self._lock = threading.Lock()\n    self._max_history = max(1, int(max_history))\n    self._current_symbol: str = \"\"\n    self._history_data: dict[str, collections.deque[float]] = {}\n    self._plot_at = plot_at\n</code></pre>"},{"location":"api-reference/core/indicators/base/#onesecondtrader.core.indicators.base.Indicator._compute_indicator","title":"<code>_compute_indicator(incoming_bar)</code>  <code>abstractmethod</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/base.py</code> <pre><code>@abc.abstractmethod\ndef _compute_indicator(self, incoming_bar: events.BarReceived) -&gt; float:\n    pass\n</code></pre>"},{"location":"api-reference/core/indicators/base/#onesecondtrader.core.indicators.base.Indicator.update","title":"<code>update(incoming_bar)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/base.py</code> <pre><code>def update(self, incoming_bar: events.BarReceived) -&gt; None:\n    symbol = incoming_bar.symbol\n    self._current_symbol = symbol\n    value = self._compute_indicator(incoming_bar)\n    with self._lock:\n        if symbol not in self._history_data:\n            self._history_data[symbol] = collections.deque(maxlen=self._max_history)\n        self._history_data[symbol].append(value)\n</code></pre>"},{"location":"api-reference/core/indicators/base/#onesecondtrader.core.indicators.base.Indicator.__getitem__","title":"<code>__getitem__(index)</code>","text":"Source code in <code>src/onesecondtrader/core/indicators/base.py</code> <pre><code>def __getitem__(self, index: int) -&gt; float:\n    # Returns np.nan on out-of-bounds access. Since np.nan comparisons always\n    # return False, strategies can skip explicit length checks.\n    try:\n        return self.history[index]\n    except IndexError:\n        return np.nan\n</code></pre>"},{"location":"api-reference/core/messaging/eventbus/","title":"Eventbus","text":""},{"location":"api-reference/core/messaging/eventbus/#onesecondtrader.core.messaging.eventbus.EventBus","title":"<code>EventBus</code>","text":""},{"location":"api-reference/core/messaging/eventbus/#onesecondtrader.core.messaging.eventbus.EventBus.__init__","title":"<code>__init__()</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/eventbus.py</code> <pre><code>def __init__(self) -&gt; None:\n    self._per_event_subscriptions: collections.defaultdict[\n        type[events.bases.EventBase], set[Subscriber]\n    ] = collections.defaultdict(set)\n    self._subscribers: set[Subscriber] = set()\n    self._lock: threading.Lock = threading.Lock()\n</code></pre>"},{"location":"api-reference/core/messaging/eventbus/#onesecondtrader.core.messaging.eventbus.EventBus.subscribe","title":"<code>subscribe(subscriber, event_type)</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/eventbus.py</code> <pre><code>def subscribe(\n    self,\n    subscriber: Subscriber,\n    event_type: type[events.bases.EventBase],\n) -&gt; None:\n    with self._lock:\n        self._subscribers.add(subscriber)\n        self._per_event_subscriptions[event_type].add(subscriber)\n</code></pre>"},{"location":"api-reference/core/messaging/eventbus/#onesecondtrader.core.messaging.eventbus.EventBus.unsubscribe","title":"<code>unsubscribe(subscriber)</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/eventbus.py</code> <pre><code>def unsubscribe(self, subscriber: Subscriber) -&gt; None:\n    with self._lock:\n        for set_of_event_subscribers in self._per_event_subscriptions.values():\n            set_of_event_subscribers.discard(subscriber)\n        self._subscribers.discard(subscriber)\n</code></pre>"},{"location":"api-reference/core/messaging/eventbus/#onesecondtrader.core.messaging.eventbus.EventBus.publish","title":"<code>publish(event)</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/eventbus.py</code> <pre><code>def publish(self, event: events.bases.EventBase) -&gt; None:\n    # Intentionally matches exact event types only, not parent classes\n    with self._lock:\n        subscribers = self._per_event_subscriptions[type(event)].copy()\n    for subscriber in subscribers:\n        subscriber.receive(event)\n</code></pre>"},{"location":"api-reference/core/messaging/eventbus/#onesecondtrader.core.messaging.eventbus.EventBus.wait_until_system_idle","title":"<code>wait_until_system_idle()</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/eventbus.py</code> <pre><code>def wait_until_system_idle(self) -&gt; None:\n    with self._lock:\n        subscribers = self._subscribers.copy()\n    for subscriber in subscribers:\n        subscriber.wait_until_idle()\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/","title":"Subscriber","text":""},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber","title":"<code>Subscriber</code>","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber.__init__","title":"<code>__init__(event_bus)</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>def __init__(self, event_bus: EventBus) -&gt; None:\n    self._event_bus = event_bus\n    self._queue: queue.Queue[events.bases.EventBase | None] = queue.Queue()\n    self._running: threading.Event = threading.Event()\n    self._running.set()\n    self._thread = threading.Thread(\n        target=self._event_loop, name=self.__class__.__name__\n    )\n    self._thread.start()\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber.receive","title":"<code>receive(event)</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>def receive(self, event: events.bases.EventBase) -&gt; None:\n    if self._running.is_set():\n        self._queue.put(event)\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber.wait_until_idle","title":"<code>wait_until_idle()</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>def wait_until_idle(self) -&gt; None:\n    if not self._running.is_set():\n        return\n    self._queue.join()\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber.shutdown","title":"<code>shutdown()</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>def shutdown(self) -&gt; None:\n    if not self._running.is_set():\n        return\n    self._event_bus.unsubscribe(self)\n    self._running.clear()\n    self._queue.put(None)\n    if threading.current_thread() is not self._thread:\n        self._thread.join()\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber._subscribe","title":"<code>_subscribe(*event_types)</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>def _subscribe(self, *event_types: type[events.bases.EventBase]) -&gt; None:\n    for event_type in event_types:\n        self._event_bus.subscribe(self, event_type)\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber._publish","title":"<code>_publish(event)</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>def _publish(self, event: events.bases.EventBase) -&gt; None:\n    self._event_bus.publish(event)\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber._event_loop","title":"<code>_event_loop()</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>def _event_loop(self) -&gt; None:\n    while True:\n        event = self._queue.get()\n        if event is None:\n            self._queue.task_done()\n            break\n        try:\n            self._on_event(event)\n        except Exception as exc:\n            self._on_exception(exc)\n        finally:\n            self._queue.task_done()\n    self._cleanup()\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber._on_exception","title":"<code>_on_exception(exc)</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>def _on_exception(self, exc: Exception) -&gt; None:\n    # Override in subclass to log or handle exceptions\n    pass\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber._cleanup","title":"<code>_cleanup()</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>def _cleanup(self) -&gt; None:\n    pass\n</code></pre>"},{"location":"api-reference/core/messaging/subscriber/#onesecondtrader.core.messaging.subscriber.Subscriber._on_event","title":"<code>_on_event(event)</code>  <code>abstractmethod</code>","text":"Source code in <code>src/onesecondtrader/core/messaging/subscriber.py</code> <pre><code>@abc.abstractmethod\ndef _on_event(self, event: events.bases.EventBase) -&gt; None:\n    # Must not block indefinitely; wait_until_idle() has no timeout\n    ...\n</code></pre>"},{"location":"api-reference/core/models/data/","title":"Data","text":""},{"location":"api-reference/core/models/data/#onesecondtrader.core.models.data.BarPeriod","title":"<code>BarPeriod</code>","text":"<p>               Bases: <code>Enum</code></p> Source code in <code>src/onesecondtrader/core/models/data.py</code> <pre><code>class BarPeriod(enum.Enum):\n    SECOND = enum.auto()\n    MINUTE = enum.auto()\n    HOUR = enum.auto()\n    DAY = enum.auto()\n</code></pre>"},{"location":"api-reference/core/models/data/#onesecondtrader.core.models.data.InputSource","title":"<code>InputSource</code>","text":"<p>               Bases: <code>Enum</code></p> Source code in <code>src/onesecondtrader/core/models/data.py</code> <pre><code>class InputSource(enum.Enum):\n    OPEN = enum.auto()\n    HIGH = enum.auto()\n    LOW = enum.auto()\n    CLOSE = enum.auto()\n    VOLUME = enum.auto()\n</code></pre>"},{"location":"api-reference/core/models/orders/","title":"Orders","text":""},{"location":"api-reference/core/models/orders/#onesecondtrader.core.models.orders.OrderType","title":"<code>OrderType</code>","text":"<p>               Bases: <code>Enum</code></p> Source code in <code>src/onesecondtrader/core/models/orders.py</code> <pre><code>class OrderType(enum.Enum):\n    LIMIT = enum.auto()\n    MARKET = enum.auto()\n    STOP = enum.auto()\n    STOP_LIMIT = enum.auto()\n</code></pre>"},{"location":"api-reference/core/models/orders/#onesecondtrader.core.models.orders.OrderSide","title":"<code>OrderSide</code>","text":"<p>               Bases: <code>Enum</code></p> Source code in <code>src/onesecondtrader/core/models/orders.py</code> <pre><code>class OrderSide(enum.Enum):\n    BUY = enum.auto()\n    SELL = enum.auto()\n</code></pre>"},{"location":"api-reference/core/models/records/","title":"Records","text":""},{"location":"api-reference/core/models/records/#onesecondtrader.core.models.records.OrderRecord","title":"<code>OrderRecord</code>  <code>dataclass</code>","text":"Source code in <code>src/onesecondtrader/core/models/records.py</code> <pre><code>@dataclasses.dataclass\nclass OrderRecord:\n    order_id: uuid.UUID\n    symbol: str\n    order_type: orders.OrderType\n    side: orders.OrderSide\n    quantity: float\n    limit_price: float | None = None\n    stop_price: float | None = None\n    filled_quantity: float = 0.0\n</code></pre>"},{"location":"api-reference/core/models/records/#onesecondtrader.core.models.records.FillRecord","title":"<code>FillRecord</code>  <code>dataclass</code>","text":"Source code in <code>src/onesecondtrader/core/models/records.py</code> <pre><code>@dataclasses.dataclass\nclass FillRecord:\n    fill_id: uuid.UUID\n    order_id: uuid.UUID\n    symbol: str\n    side: orders.OrderSide\n    quantity: float\n    price: float\n    commission: float\n    ts_event: pd.Timestamp\n</code></pre>"},{"location":"api-reference/core/strategies/base/","title":"Base","text":""},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase","title":"<code>StrategyBase</code>","text":"<p>               Bases: <code>Subscriber</code>, <code>ABC</code></p> Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def position(self) -&gt; float:\n    return self._positions.get(self._current_symbol, 0.0)\n</code></pre> Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def avg_price(self) -&gt; float:\n    return self._avg_prices.get(self._current_symbol, 0.0)\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase.position","title":"<code>position</code>  <code>property</code>","text":""},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase.avg_price","title":"<code>avg_price</code>  <code>property</code>","text":""},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase.__init__","title":"<code>__init__(event_bus)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def __init__(self, event_bus: messaging.EventBus) -&gt; None:\n    super().__init__(event_bus)\n    self._subscribe(\n        events.BarReceived,\n        events.OrderSubmissionAccepted,\n        events.OrderModificationAccepted,\n        events.OrderCancellationAccepted,\n        events.OrderSubmissionRejected,\n        events.OrderModificationRejected,\n        events.OrderCancellationRejected,\n        events.OrderFilled,\n        events.OrderExpired,\n    )\n\n    self._current_symbol: str = \"\"\n    self._current_ts: pd.Timestamp = pd.Timestamp.now(tz=\"UTC\")\n    self._indicators: list[indicators.Indicator] = []\n\n    self._fills: dict[str, list[models.FillRecord]] = {}\n    self._positions: dict[str, float] = {}\n    self._avg_prices: dict[str, float] = {}\n    self._pending_orders: dict[uuid.UUID, models.OrderRecord] = {}\n    self._submitted_orders: dict[uuid.UUID, models.OrderRecord] = {}\n    self._submitted_modifications: dict[uuid.UUID, models.OrderRecord] = {}\n    self._submitted_cancellations: dict[uuid.UUID, models.OrderRecord] = {}\n\n    # OHLCV as indicators for history access: self.bar.close.history\n    self.bar = SimpleNamespace(\n        open=self.add_indicator(indicators.Open()),\n        high=self.add_indicator(indicators.High()),\n        low=self.add_indicator(indicators.Low()),\n        close=self.add_indicator(indicators.Close()),\n        volume=self.add_indicator(indicators.Volume()),\n    )\n\n    # Hook for subclasses to register indicators without overriding __init__\n    self.setup()\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase.add_indicator","title":"<code>add_indicator(ind)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def add_indicator(self, ind: indicators.Indicator) -&gt; indicators.Indicator:\n    self._indicators.append(ind)\n    return ind\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase.submit_order","title":"<code>submit_order(order_type, side, quantity, limit_price=None, stop_price=None)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def submit_order(\n    self,\n    order_type: models.OrderType,\n    side: models.OrderSide,\n    quantity: float,\n    limit_price: float | None = None,\n    stop_price: float | None = None,\n) -&gt; uuid.UUID:\n    # Uses bar timestamp for backtest compatibility; ts_created tracks real wall-clock time\n    order_id = uuid.uuid4()\n\n    event = events.OrderSubmission(\n        ts_event=self._current_ts,\n        system_order_id=order_id,\n        symbol=self._current_symbol,\n        order_type=order_type,\n        side=side,\n        quantity=quantity,\n        limit_price=limit_price,\n        stop_price=stop_price,\n    )\n\n    order = models.OrderRecord(\n        order_id=order_id,\n        symbol=self._current_symbol,\n        order_type=order_type,\n        side=side,\n        quantity=quantity,\n        limit_price=limit_price,\n        stop_price=stop_price,\n    )\n\n    self._submitted_orders[order_id] = order\n    self._publish(event)\n    return order_id\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase.submit_modification","title":"<code>submit_modification(order_id, quantity=None, limit_price=None, stop_price=None)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def submit_modification(\n    self,\n    order_id: uuid.UUID,\n    quantity: float | None = None,\n    limit_price: float | None = None,\n    stop_price: float | None = None,\n) -&gt; bool:\n    original_order = self._pending_orders.get(order_id)\n    if original_order is None:\n        return False\n\n    event = events.OrderModification(\n        ts_event=self._current_ts,\n        system_order_id=order_id,\n        symbol=original_order.symbol,\n        quantity=quantity,\n        limit_price=limit_price,\n        stop_price=stop_price,\n    )\n\n    modified_order = models.OrderRecord(\n        order_id=order_id,\n        symbol=original_order.symbol,\n        order_type=original_order.order_type,\n        side=original_order.side,\n        quantity=quantity if quantity is not None else original_order.quantity,\n        limit_price=(\n            limit_price if limit_price is not None else original_order.limit_price\n        ),\n        stop_price=(\n            stop_price if stop_price is not None else original_order.stop_price\n        ),\n        filled_quantity=original_order.filled_quantity,\n    )\n\n    self._submitted_modifications[order_id] = modified_order\n    self._publish(event)\n    return True\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase.submit_cancellation","title":"<code>submit_cancellation(order_id)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def submit_cancellation(self, order_id: uuid.UUID) -&gt; bool:\n    original_order = self._pending_orders.get(order_id)\n    if original_order is None:\n        return False\n\n    event = events.OrderCancellation(\n        ts_event=self._current_ts,\n        system_order_id=order_id,\n        symbol=original_order.symbol,\n    )\n\n    self._submitted_cancellations[order_id] = original_order\n    self._publish(event)\n    return True\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_event","title":"<code>_on_event(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_event(self, event: events.EventBase) -&gt; None:\n    match event:\n        case events.BarReceived() as bar_event:\n            self._on_bar_received(bar_event)\n        case events.OrderSubmissionAccepted() as accepted:\n            self._on_order_submission_accepted(accepted)\n        case events.OrderModificationAccepted() as accepted:\n            self._on_order_modification_accepted(accepted)\n        case events.OrderCancellationAccepted() as accepted:\n            self._on_order_cancellation_accepted(accepted)\n        case events.OrderSubmissionRejected() as rejected:\n            self._on_order_submission_rejected(rejected)\n        case events.OrderModificationRejected() as rejected:\n            self._on_order_modification_rejected(rejected)\n        case events.OrderCancellationRejected() as rejected:\n            self._on_order_cancellation_rejected(rejected)\n        case events.OrderFilled() as filled:\n            self._on_order_filled(filled)\n        case events.OrderExpired() as expired:\n            self._on_order_expired(expired)\n        case _:\n            return\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_bar_received","title":"<code>_on_bar_received(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_bar_received(self, event: events.BarReceived) -&gt; None:\n    if event.symbol not in self.symbols:\n        return\n    if event.bar_period != self.bar_period:\n        return\n\n    self._current_symbol = event.symbol\n    self._current_ts = event.ts_event\n\n    for ind in self._indicators:\n        ind.update(event)\n\n    self._emit_processed_bar(event)\n    self.on_bar(event)\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._emit_processed_bar","title":"<code>_emit_processed_bar(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _emit_processed_bar(self, event: events.BarReceived) -&gt; None:\n    ohlcv_names = {\"OPEN\", \"HIGH\", \"LOW\", \"CLOSE\", \"VOLUME\"}\n\n    indicator_values = {\n        f\"{ind.plot_at:02d}_{ind.name}\": ind.latest\n        for ind in self._indicators\n        if ind.name not in ohlcv_names\n    }\n\n    processed_bar = events.BarProcessed(\n        ts_event=event.ts_event,\n        symbol=event.symbol,\n        bar_period=event.bar_period,\n        open=event.open,\n        high=event.high,\n        low=event.low,\n        close=event.close,\n        volume=event.volume,\n        indicators=indicator_values,\n    )\n\n    self._publish(processed_bar)\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_order_submission_accepted","title":"<code>_on_order_submission_accepted(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_order_submission_accepted(\n    self, event: events.OrderSubmissionAccepted\n) -&gt; None:\n    order = self._submitted_orders.pop(event.associated_order_id, None)\n    if order is not None:\n        self._pending_orders[event.associated_order_id] = order\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_order_modification_accepted","title":"<code>_on_order_modification_accepted(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_order_modification_accepted(\n    self, event: events.OrderModificationAccepted\n) -&gt; None:\n    modified_order = self._submitted_modifications.pop(\n        event.associated_order_id, None\n    )\n    if modified_order is not None:\n        self._pending_orders[event.associated_order_id] = modified_order\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_order_cancellation_accepted","title":"<code>_on_order_cancellation_accepted(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_order_cancellation_accepted(\n    self, event: events.OrderCancellationAccepted\n) -&gt; None:\n    self._submitted_cancellations.pop(event.associated_order_id, None)\n    self._pending_orders.pop(event.associated_order_id, None)\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_order_submission_rejected","title":"<code>_on_order_submission_rejected(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_order_submission_rejected(\n    self, event: events.OrderSubmissionRejected\n) -&gt; None:\n    self._submitted_orders.pop(event.associated_order_id, None)\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_order_modification_rejected","title":"<code>_on_order_modification_rejected(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_order_modification_rejected(\n    self, event: events.OrderModificationRejected\n) -&gt; None:\n    self._submitted_modifications.pop(event.associated_order_id, None)\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_order_cancellation_rejected","title":"<code>_on_order_cancellation_rejected(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_order_cancellation_rejected(\n    self, event: events.OrderCancellationRejected\n) -&gt; None:\n    self._submitted_cancellations.pop(event.associated_order_id, None)\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_order_filled","title":"<code>_on_order_filled(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_order_filled(self, event: events.OrderFilled) -&gt; None:\n    # Track partial fills: only remove order when fully filled\n    order = self._pending_orders.get(event.associated_order_id)\n    if order:\n        order.filled_quantity += event.quantity_filled\n        if order.filled_quantity &gt;= order.quantity:\n            self._pending_orders.pop(event.associated_order_id)\n\n    fill = models.FillRecord(\n        fill_id=event.fill_id,\n        order_id=event.associated_order_id,\n        symbol=event.symbol,\n        side=event.side,\n        quantity=event.quantity_filled,\n        price=event.fill_price,\n        commission=event.commission,\n        ts_event=event.ts_event,\n    )\n\n    self._fills.setdefault(event.symbol, []).append(fill)\n    self._update_position(event)\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._update_position","title":"<code>_update_position(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _update_position(self, event: events.OrderFilled) -&gt; None:\n    symbol = event.symbol\n    fill_qty = event.quantity_filled\n    fill_price = event.fill_price\n\n    signed_qty = 0.0\n    match event.side:\n        case models.OrderSide.BUY:\n            signed_qty = fill_qty\n        case models.OrderSide.SELL:\n            signed_qty = -fill_qty\n\n    old_pos = self._positions.get(symbol, 0.0)\n    old_avg = self._avg_prices.get(symbol, 0.0)\n    new_pos = old_pos + signed_qty\n\n    if new_pos == 0.0:\n        new_avg = 0.0\n    elif old_pos == 0.0:\n        new_avg = fill_price\n    elif (old_pos &gt; 0 and signed_qty &gt; 0) or (old_pos &lt; 0 and signed_qty &lt; 0):\n        new_avg = (old_avg * abs(old_pos) + fill_price * abs(signed_qty)) / abs(\n            new_pos\n        )\n    else:\n        if abs(new_pos) &lt;= abs(old_pos):\n            new_avg = old_avg\n        else:\n            new_avg = fill_price\n\n    self._positions[symbol] = new_pos\n    self._avg_prices[symbol] = new_avg\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase._on_order_expired","title":"<code>_on_order_expired(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def _on_order_expired(self, event: events.OrderExpired) -&gt; None:\n    self._pending_orders.pop(event.associated_order_id, None)\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase.setup","title":"<code>setup()</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>def setup(self) -&gt; None:\n    pass\n</code></pre>"},{"location":"api-reference/core/strategies/base/#onesecondtrader.core.strategies.base.StrategyBase.on_bar","title":"<code>on_bar(event)</code>  <code>abstractmethod</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/base.py</code> <pre><code>@abc.abstractmethod\ndef on_bar(self, event: events.BarReceived) -&gt; None:\n    pass\n</code></pre>"},{"location":"api-reference/core/strategies/examples/","title":"Examples","text":""},{"location":"api-reference/core/strategies/examples/#onesecondtrader.core.strategies.examples.SMACrossover","title":"<code>SMACrossover</code>","text":"<p>               Bases: <code>StrategyBase</code></p>"},{"location":"api-reference/core/strategies/examples/#onesecondtrader.core.strategies.examples.SMACrossover.setup","title":"<code>setup()</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/examples.py</code> <pre><code>def setup(self) -&gt; None:\n    self.fast_sma = self.add_indicator(\n        indicators.SimpleMovingAverage(period=self.fast_period)\n    )\n    self.slow_sma = self.add_indicator(\n        indicators.SimpleMovingAverage(period=self.slow_period)\n    )\n</code></pre>"},{"location":"api-reference/core/strategies/examples/#onesecondtrader.core.strategies.examples.SMACrossover.on_bar","title":"<code>on_bar(event)</code>","text":"Source code in <code>src/onesecondtrader/core/strategies/examples.py</code> <pre><code>def on_bar(self, event: events.BarReceived) -&gt; None:\n    if (\n        self.fast_sma[-2] &lt;= self.slow_sma[-2]\n        and self.fast_sma.latest &gt; self.slow_sma.latest\n        and self.position &lt;= 0\n    ):\n        self.submit_order(\n            models.OrderType.MARKET, models.OrderSide.BUY, self.quantity\n        )\n\n    if (\n        self.fast_sma[-2] &gt;= self.slow_sma[-2]\n        and self.fast_sma.latest &lt; self.slow_sma.latest\n        and self.position &gt;= 0\n    ):\n        self.submit_order(\n            models.OrderType.MARKET, models.OrderSide.SELL, self.quantity\n        )\n</code></pre>"},{"location":"api-reference/secmaster/schema/","title":"Schema","text":"<p>Security Master Database Schema</p> <p>Stores instrument metadata and OHLCV market data. Prices are stored as fixed-point integers (scale factor \\(10^9\\)) to avoid floating-point errors. Timestamps are nanoseconds since Unix epoch.</p>"},{"location":"api-reference/secmaster/schema/#publishers","title":"publishers","text":"<p>Data providers. Separated from instruments because the same symbol (e.g., <code>ESH5</code>) may exist across multiple vendors with different <code>instrument_id</code>s.</p> <pre><code>CREATE TABLE publishers (\n    publisher_id INTEGER PRIMARY KEY,\n    name TEXT NOT NULL UNIQUE,\n    dataset TEXT NOT NULL,\n    venue TEXT\n);\n</code></pre>"},{"location":"api-reference/secmaster/schema/#instruments","title":"instruments","text":"<p>Security/instrument metadata. The UNIQUE constraint on (<code>publisher_id</code>, <code>raw_symbol</code>) allows the same symbol from different vendors while preventing duplicates.</p> <pre><code>CREATE TABLE instruments (\n    instrument_id INTEGER PRIMARY KEY,\n    publisher_id INTEGER NOT NULL,\n    raw_symbol TEXT NOT NULL,\n    instrument_class TEXT NOT NULL DEFAULT 'K',\n    exchange TEXT,\n    currency TEXT DEFAULT 'USD',\n    min_price_increment INTEGER,\n    ts_recv INTEGER NOT NULL,\n    FOREIGN KEY (publisher_id) REFERENCES publishers(publisher_id),\n    UNIQUE(publisher_id, raw_symbol)\n);\n</code></pre>"},{"location":"api-reference/secmaster/schema/#ohlcv","title":"ohlcv","text":"<p>OHLCV bar data. The primary key order (<code>instrument_id</code>, <code>rtype</code>, <code>ts_event</code>) ensures bars for the same instrument/timeframe are contiguous on disk, making range queries fast. <code>WITHOUT ROWID</code> stores data directly in the primary key B-tree, eliminating the indirection of a separate rowid lookup.</p> <pre><code>CREATE TABLE ohlcv (\n    instrument_id INTEGER NOT NULL,\n    rtype INTEGER NOT NULL,\n    ts_event INTEGER NOT NULL,\n    open INTEGER NOT NULL,\n    high INTEGER NOT NULL,\n    low INTEGER NOT NULL,\n    close INTEGER NOT NULL,\n    volume INTEGER NOT NULL,\n    FOREIGN KEY (instrument_id) REFERENCES instruments(instrument_id),\n    PRIMARY KEY (instrument_id, rtype, ts_event)\n) WITHOUT ROWID;\n</code></pre>"},{"location":"api-reference/secmaster/utils/","title":"Utils","text":""},{"location":"api-reference/secmaster/utils/#onesecondtrader.secmaster.utils.init_secmaster","title":"<code>init_secmaster(db_path)</code>","text":"<p>Initialize a new secmaster database at the specified path.</p> <p>Creates the database file with the schema defined in schema.sql (publishers, instruments, and ohlcv tables) but does not populate any data.</p> <p>Parameters:</p> Name Type Description Default <code>db_path</code> <code>Path</code> <p>Path where the database file will be created.</p> required <p>Raises:</p> Type Description <code>FileExistsError</code> <p>If a database already exists at the path.</p> Source code in <code>src/onesecondtrader/secmaster/utils.py</code> <pre><code>def init_secmaster(db_path: pathlib.Path) -&gt; None:\n    \"\"\"Initialize a new secmaster database at the specified path.\n\n    Creates the database file with the schema defined in schema.sql (publishers, instruments,\n    and ohlcv tables) but does not populate any data.\n\n    Args:\n        db_path: Path where the database file will be created.\n\n    Raises:\n        FileExistsError: If a database already exists at the path.\n    \"\"\"\n    if db_path.exists():\n        raise FileExistsError(f\"Database already exists: {db_path}\")\n    db_path.parent.mkdir(parents=True, exist_ok=True)\n    schema_path = pathlib.Path(__file__).parent / \"schema.sql\"\n    conn = sqlite3.connect(str(db_path))\n    conn.executescript(schema_path.read_text())\n    conn.commit()\n    conn.close()\n</code></pre>"},{"location":"documentation/overview/","title":"Read the Docs","text":""},{"location":"documentation/overview/#introduction","title":"Introduction","text":"<p>At its core, the OneSecondTrader package enables users to implement a trading strategy and execute it by connecting two interchangeable components: a data feed and a broker. Both components may operate either in simulated mode\u2014using historical market data and a simulated execution layer\u2014or in live or paper-trading mode via a live data feed and a real broker API.</p> <p>A central design principle of the system is that backtesting and live trading follow the same execution flow from market data ingestion to order handling, while differing only in the concrete implementations of the data feed and broker. As a result, transitioning a strategy from historical simulation to live deployment requires no changes to the strategy code itself.</p> <p>This architectural decision ensures that any discrepancy between backtested and live performance can be attributed exclusively to the fidelity of the simulations.  On the data side, this concerns how accurately the imitation of a live datafeed from historical records approximates real-time market behavior. On the execution side, it concerns how well the simulated broker models real-world constraints such as slippage, partial fills, et cetera. </p> <p>By strictly isolating these sources of divergence, OneSecondTrader provides a controlled and transparent environment for strategy development, validation, and deployment, without the risk of structural mismatches between research and production.</p>"},{"location":"documentation/overview/#package-structure","title":"Package Structure","text":"<p>The OneSecondTrader library is organized as a top-level Python package composed of four sub-packages (<code>core</code>, <code>connectors</code>, <code>secmaster</code>, and <code>dashboard</code>), each encapsulating an architecturally distinct set of responsibilities.</p> <ul> <li> <p><code>core</code>: Provides the skeleton of an event-driven trading system. It does include the definition of a set of events which are used to communicate between the different system components, an event bus for routing events to the concerned components, as well as base classes for strategies, brokers, and indicators. It does not include any datafeed component or any actual broker implementation, which are provided by the <code>connectors</code> package to isolate external dependencies from the system's core logic.</p> </li> <li> <p><code>connectors</code> Provides actual implementations of brokers and datafeeds. This includes both the (internally) simulated broker and datafeed as well as connectors to actual live brokers and datafeeds APIs. This makes it possible for the core of the system to stay the same, while the options for connecting to actual live brokers and datafeeds can be expanded as needed.</p> </li> <li> <p><code>secmaster</code>: Povides the skeleton for a securities master database as well as some utilities to actually ingest data from various sources into this database. Simulated datafeeds (see <code>connectors</code> package) will use it as a source of market data.</p> </li> <li> <p><code>dashboard</code>: Provides a web-based dashboard to view and control the runs of the trading system. A run refers to a single execution of the trading system, and is associated with a concrete instance of a strategy (or instances of multiple strategies), as well as the connected broker and datafeed.  The backend of the dashboard is organized around a database that persistently records all run-related activity on a per-run basis. The frontend is implemented as a web application that presents this information in a form suitable for both inspection  and operational decision-making. Backtests differ from live runs only in temporal behavior. Backtests complete quickly, as historical data is replayed at maximum speed, whereas live runs naturally unfold in real time.</p> </li> </ul>"},{"location":"documentation/overview/#system-core-core-package","title":"System Core (<code>core</code> package)","text":"<p>Under Construction</p> <p>This part of the documentation is still under construction! If necessary, have a look at the API reference for now.</p>"},{"location":"documentation/overview/#broker-and-datafeed-connectors-connectors-package","title":"Broker and Datafeed Connectors (<code>connectors</code> package)","text":"<p>Under Construction</p> <p>This part of the documentation is still under construction! If necessary, have a look at the API reference for now.</p>"},{"location":"documentation/overview/#securities-master-database-secmaster-package","title":"Securities Master Database (<code>secmaster</code> package)","text":""},{"location":"documentation/overview/#introduction_1","title":"Introduction","text":"<p>The securities master database stores market data for use by the simulated datafeed when replaying historical data during backtesting. It is implemented as an SQLite database and populated via utilities provided by the <code>secmaster</code> package. SQLite is an embedded database engine that stores the entire database in a single file and requires no server or external configuration, making it well suited for market data storage due to its simplicity, portability, read performance, and reliability.</p> <p>For background on SQL and database concepts used in this schema, see the SQL Primer.</p>"},{"location":"documentation/overview/#schema-design-decisions","title":"Schema Design Decisions","text":"<ul> <li>Prices as integers: Floating-point numbers can't represent all decimal values exactly, so prices are stored as integers using fixed-point arithmetic with a scale factor of \\(10^9\\)\u2014guaranteeing exact representation and fast integer arithmetic.</li> <li>Nanosecond timestamps: Timestamps are stored as integers representing nanoseconds since the Unix epoch, preserving microsecond/nanosecond ordering information, avoiding conversion errors, and matching data vendor formats like Databento.</li> <li>Primary key order: The <code>ohlcv</code> primary key <code>(instrument_id, rtype, ts_event)</code> ensures all bars for the same instrument are contiguous on disk, enabling the common query pattern \"bars for instrument X, timeframe Y, between time A and B\" to become a fast sequential read.</li> </ul>"},{"location":"documentation/overview/#dashboard-dashboard-package","title":"Dashboard (<code>dashboard</code> package)","text":"<p>Under Construction</p> <p>This part of the documentation is still under construction! If necessary, have a look at the API reference for now.</p>"}]}